#!/bin/sh

cd $(dirname $([ -L $0 ] && readlink -f $0 || echo $0))
DIRNAME=$(pwd)

echo -n "Provide your username\n"
read username

echo -n "Provide your working directory name\n"
read work_dir

echo -n "Provide your github username\n"
read git_user

MAIN_DIR=$HOME/$work_dir
ZSH_DIR=$MAIN_DIR/.local/etc/zsh
LOCAL_DIR=$MAIN_DIR/.local

sudo apt install -y fzf git make build-essential lua5.4 openssh-server curl \
    zsh cowsay wget flameshot  libxft-dev libxinerama-dev libxrandr-dev  \
    libharfbuzz-dev neofetch picom fonts-hermit feh alsa-utils gcc g++ \
    libfreetype6-dev libglib2.0-dev libcairo2-dev fonts-font-awesome \
    ffmpeg playerctl ranger mpv xclip scrot imagemagick \
    software-properties-common i3, dunst, nm-tray, blueman, geoclue-2.0

sudo apt update && sudo apt upgrade

flatpak install spotify slack

#cowsay "Installing oh-my-zh and powerlevel10k"

wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Regular.ttf
wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold.ttf
wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Italic.ttf
wget https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold%20Italic.ttf

sudo mkdir /usr/share/fonts/truetype/meslo && sudo mv *.ttf /usr/share/fonts/truetype/meslo/

wget https://github.com/ryanoasis/nerd-fonts/releases/latest/download/Hack.zip
mkdir ~/.local/share/fonts
unzip Hack.zip -d HackTTF && mv HackTTF ~/.local/share/fonts/

cd $HOME
#sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
#
#git clone https://github.com/romkatv/powerlevel10k.git $ZSH_CUSTOM/themes/powerlevel10k
#
#git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
#git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions

cowsay "Setting up neovim"

sudo add-apt-repository ppa:neovim-ppa/unstable
sudo apt-get update
sudo apt-get install neovim


git clone git@github.com:$git_user/nvim.git $HOME/.config/nvim
git clone git@github.com:$git_user/.local.git $MAIN_DIR/.local

git clone --depth 1 https://github.com/wbthomason/packer.nvim\
	 ~/.local/share/nvim/site/pack/packer/start/packer.neovim

rm $HOME/.zshrc
rm $HOME/.xinitrc
sudo cp $LOCAL_DIR/share/dwm.desktop /usr/share/xsessions/dwm.desktop
mkdir $HOME/.config/i3
ln -s $LOCAL_DIR/etc/.xinitrc $HOME/
ln -s $ZSH_DIR/.zshenv $HOME/
ln -s $LOCAL_DIR/etc/.tmux.conf $HOME/
ln -s $LOCAL_DIR/etc/picom.conf $HOME/.config
ln -s $LOCAL_DIR/bin/dwm_exec $HOME/
ln -s $LOCAL_DIR/etc/config $HOME/.config/i3/


cd $MAIN_DIR/suckless/dwm && sudo make clean install
cd $MAIN_DIR/suckless/slstatus && sudo make clean install
cd $MAIN_DIR/suckless/st && sudo make clean install
cd $MAIN_DIR/suckless/dmenu && sudo make clean install
cd $MAIN_DIR/suckless/slock && sudo make clean install

curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash

cowsay "Restart the shell and do:\
nvm install node\
source ~/.bashrc\
cd ~/.config/nvim && nvm use node\
to complete neovim installation"
